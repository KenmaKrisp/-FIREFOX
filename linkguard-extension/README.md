## LinkGuard — расширение для Firefox

LinkGuard показывает доверие к ссылкам при наведении курсора и предупреждает о фишинговых доменах (тайпсквотинг, омоглифы). Расширение работает полностью локально, без отправки URL на сторонние сервисы.

### Архитектура

- `content_script.js` — обрабатывает события `mouseover`/`mouseout`, отбирает ссылки в зависимости от выбранного режима, запрашивает проверку у background-скрипта и рисует всплывающую карточку с учётом пользовательской темы (минимальная / стандартная / полная).
- `background.js` — нормализует домены, сравнивает с белым списком, выполняет эвристики (Левенштейн, омоглифы) и возвращает структурированный отчёт: статус, пояснение, чек-лист проверок и метрику тайпсквотинга.
- `popup.html/css/js` — панель настроек. Позволяет выбрать чувствительность (только внешние ссылки или все HTTP/HTTPS-ссылки на странице) и стиль карточки. Настройки сохраняются в `browser.storage.local` и подхватываются контент-скриптом без перезагрузки страницы.
- `styles.css` — тема всплывающего окна (три пресета через `data-ui`), бейджи, шкала тайпсквотинга.
- `manifest.json` — объявляет фоновые/контентные скрипты, стили и popup.

### Алгоритм анализа

1. Контент-скрипт извлекает `hostname` ссылки, нормализует его (lowercase, без `www.`) и отправляет в background.
2. `background.js` проверяет:
   - **Белый список** (`SAFE_DOMAINS`). Попадание = статус `safe`, риск тайпсквотинга 0.
   - **Расстояние Левенштейна** до whitelisted-доменов. Если `<= 2` → статус `danger` и высокий риск.
   - **Омоглифы** — удаление диакритики и не ASCII символов, сравнение с whitelisted доменами.
   - **Прочие**: ближайший домен и расстояние (если в пределах `TYPO_MAX_DISTANCE`), чтобы оценить риск `warning`.
3. Ответ возвращает:
   - `status`: `safe | warning | danger | unknown`.
   - `reason`: пояснение для тултипа.
   - `checks`: массив из трёх блоков (whitelist, анализ угроз, риск тайпсквотинга) с уровнем (`success/warning/danger`).
   - `typo`: объект с баллом (0–100), severity (`safe/warning/danger`) и названием похожего домена, если найден.
4. Контент-скрипт рисует карточку:
   - Минимальный режим: только заголовок + пояснение.
   - Стандартный: плюс чек-лист.
   - Полный: чек-лист, шкала тайпсквотинга, кнопка “Пожаловаться”.

### Как запустить локально

1. Установить Firefox Developer/Nightly и `web-ext` (`npm i -g web-ext`).
2. Из папки проекта:
   ```bash
   web-ext run --firefox="C:\Program Files\Mozilla Firefox\firefox.exe"
   ```
   или загрузить папку через `about:debugging`.
3. В popup расширения выбрать режим проверки и тему; изменения вступают в силу сразу.

### Возможные доработки

- Расширяемый whitelist (синхронизация с сервером или пользовательский список).
- Интеграция с внешними API репутации.
- Журнал проверок и отчёт о подозрительных ссылках.

Если нужны дополнительные инструкции (тесты, сборка), дай знать — дополним README.

